<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="../libraries/jquery-3.5.1.min.js"></script>
    <title>Ball?</title>
</head>
<body>
    <div id="setup">
        <div>
            <button id="finish_setup">Done!</button>
            <h2>Input initial launch angle (89 - 1)</h2>
            <input type="text" name="angle" id="angle">
        </div>
    </div>
    <main>
        <h2 id="coords_text">Coords: (0, 0)</h2>
        <div id="ball"></div>
        <div id="trace"></div>
    </main>
</body>
<script>
//>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<\\

//>- Jquery setup -<\\
$(document).ready(() => {
    $("#finish_setup").click(() => {
        let angle = $("#angle").val();
        if (!isNaN(angle) && angle < 90 && angle > 0) {
            x_change = 5 * Math.cos(angle * Math.PI / 180);
            y_change = 5 * Math.sin(angle * Math.PI / 180);
            loop_active = true;
            $("main").css("display", "grid");
            $("#setup").hide();
        } else {
            alert("error on input\ntry again")
        }
    });
    $(window).resize(() => {
        coords.x = 0; coords.y = 0;
    });
});

//>- main loop -<\\
// tick speed: 20 mill per tick / 50 ticks per second
/*> keeping the same direction, but changing angle on bounce

   angle = a
distance = d
x_change = x
y_change = y

x = (d * cos(a))
y = (d * sin(a))

*/
let rnd = (num) => { return Math.floor(Math.round(num)); }
let cos = (ang) => { return Math.cos(ang * Math.PI / 180); }
let sin = (ang) => { return Math.sin(ang * Math.PI / 180); }
let new_angle = (ang) => {
    x_change = 5 * cos(ang);
    y_change = 5 * sin(ang);
}

let ball = $("#ball");
let coords = {
    x: 0,
    y: 0,
};
let y_change = 5;
let x_change = 10;
let y_pos = true;
let x_pos = true;
let loop_active = false;
let main_loop = setInterval(() => {
    if (loop_active) {
        let scene_size = {
            w: ($("body")[0].clientWidth),
            h: ($("body")[0].clientHeight),
        }
        

        if (x_pos) {
            coords.x += x_change;
        } else {
            coords.x -= x_change;
        }
        if (y_pos) {
            coords.y += y_change;
        } else {
            coords.y -= y_change;
        }

        if ((coords.y + $("#ball")[0].clientHeight) > scene_size.h || (coords.y < 0)) {
            y_pos = !y_pos;
        }
        if ((coords.x + $("#ball")[0].clientWidth) > scene_size.w || (coords.x < 0)) {
            x_pos = !x_pos;
        }

        document.getElementById("coords_text").innerHTML = `x: ${rnd(coords.x)}<br>y: ${rnd(coords.y)}`;

        $("#ball").css("left", `${coords.x}px`).css("bottom", `${coords.y}px`);
    }
}, 20); //clearInterval(main_loop);

//>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<\\
</script>
</html>